

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Query PK-DB &mdash; pkdb_analysis  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Working with PK-DB data" href="data_examples.html" />
    <link rel="prev" title="Welcome to PKDB’s documentation!" href="../index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> pkdb_analysis
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Query PK-DB</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_examples.html">Working with PK-DB data</a></li>
<li class="toctree-l1"><a class="reference internal" href="filter_examples.html">Filter data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pkdb_analysis</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Query PK-DB</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/query_examples.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
</pre></div>
</div>
<div class="section" id="query-pk-db">
<h1>Query PK-DB<a class="headerlink" href="#query-pk-db" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>how to set the endpoint for queries</p></li>
<li><p>how to query data from PKDB</p></li>
</ul>
<p>To query the complete database content we can do</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pkdb_analysis</span> <span class="kn">import</span> <span class="n">PKDB</span><span class="p">,</span> <span class="n">PKData</span><span class="p">,</span> <span class="n">PKFilter</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_study_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Adithan1982&quot;</span><span class="p">]</span>
<span class="n">url_study_names</span> <span class="o">=</span> <span class="s2">&quot;__&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_study_names</span><span class="p">)</span>
<span class="n">pkfilter</span> <span class="o">=</span> <span class="n">PKFilter</span><span class="p">()</span>
<span class="k">for</span> <span class="n">df_key</span> <span class="ow">in</span> <span class="p">[</span>
    <span class="s2">&quot;studies&quot;</span><span class="p">,</span>
    <span class="s2">&quot;groups&quot;</span><span class="p">,</span>
    <span class="s2">&quot;individuals&quot;</span><span class="p">,</span>
    <span class="s2">&quot;interventions&quot;</span><span class="p">,</span>
    <span class="s2">&quot;outputs&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timecourses&quot;</span><span class="p">,</span>
<span class="p">]:</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">pkfilter</span><span class="p">,</span> <span class="n">df_key</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;study_name__in&quot;</span><span class="p">:</span> <span class="n">url_study_names</span><span class="p">})</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">PKDB</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">pkfilter</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">ConnectionRefusedError</span>                    <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">urllib3</span><span class="o">/</span><span class="n">connection</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">_new_conn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="mi">159</span>             <span class="n">conn</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">create_connection</span><span class="p">(</span>
<span class="o">--&gt;</span> <span class="mi">160</span>                 <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dns_host</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">,</span> <span class="o">**</span><span class="n">extra_kw</span>
    <span class="mi">161</span>             <span class="p">)</span>


<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">urllib3</span><span class="o">/</span><span class="n">util</span><span class="o">/</span><span class="n">connection</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">create_connection</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">source_address</span><span class="p">,</span> <span class="n">socket_options</span><span class="p">)</span>
     <span class="mi">83</span>     <span class="k">if</span> <span class="n">err</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="o">---&gt;</span> <span class="mi">84</span>         <span class="k">raise</span> <span class="n">err</span>
     <span class="mi">85</span>


<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">urllib3</span><span class="o">/</span><span class="n">util</span><span class="o">/</span><span class="n">connection</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">create_connection</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">source_address</span><span class="p">,</span> <span class="n">socket_options</span><span class="p">)</span>
     <span class="mi">73</span>                 <span class="n">sock</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">source_address</span><span class="p">)</span>
<span class="o">---&gt;</span> <span class="mi">74</span>             <span class="n">sock</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">sa</span><span class="p">)</span>
     <span class="mi">75</span>             <span class="k">return</span> <span class="n">sock</span>


<span class="ne">ConnectionRefusedError</span><span class="p">:</span> <span class="p">[</span><span class="n">Errno</span> <span class="mi">111</span><span class="p">]</span> <span class="n">Connection</span> <span class="n">refused</span>


<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>


<span class="n">NewConnectionError</span>                        <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">urllib3</span><span class="o">/</span><span class="n">connectionpool</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">urlopen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">retries</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">assert_same_host</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">pool_timeout</span><span class="p">,</span> <span class="n">release_conn</span><span class="p">,</span> <span class="n">chunked</span><span class="p">,</span> <span class="n">body_pos</span><span class="p">,</span> <span class="o">**</span><span class="n">response_kw</span><span class="p">)</span>
    <span class="mi">676</span>                 <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
<span class="o">--&gt;</span> <span class="mi">677</span>                 <span class="n">chunked</span><span class="o">=</span><span class="n">chunked</span><span class="p">,</span>
    <span class="mi">678</span>             <span class="p">)</span>


<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">urllib3</span><span class="o">/</span><span class="n">connectionpool</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">_make_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conn</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">chunked</span><span class="p">,</span> <span class="o">**</span><span class="n">httplib_request_kw</span><span class="p">)</span>
    <span class="mi">391</span>         <span class="k">else</span><span class="p">:</span>
<span class="o">--&gt;</span> <span class="mi">392</span>             <span class="n">conn</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">httplib_request_kw</span><span class="p">)</span>
    <span class="mi">393</span>


<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">client</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">encode_chunked</span><span class="p">)</span>
   <span class="mi">1276</span>         <span class="s2">&quot;&quot;&quot;Send a complete request to the server.&quot;&quot;&quot;</span>
<span class="o">-&gt;</span> <span class="mi">1277</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_send_request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">encode_chunked</span><span class="p">)</span>
   <span class="mi">1278</span>


<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">client</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">_send_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">encode_chunked</span><span class="p">)</span>
   <span class="mi">1322</span>             <span class="n">body</span> <span class="o">=</span> <span class="n">_encode</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="s1">&#39;body&#39;</span><span class="p">)</span>
<span class="o">-&gt;</span> <span class="mi">1323</span>         <span class="bp">self</span><span class="o">.</span><span class="n">endheaders</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="n">encode_chunked</span><span class="o">=</span><span class="n">encode_chunked</span><span class="p">)</span>
   <span class="mi">1324</span>


<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">client</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">endheaders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message_body</span><span class="p">,</span> <span class="n">encode_chunked</span><span class="p">)</span>
   <span class="mi">1271</span>             <span class="k">raise</span> <span class="n">CannotSendHeader</span><span class="p">()</span>
<span class="o">-&gt;</span> <span class="mi">1272</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_send_output</span><span class="p">(</span><span class="n">message_body</span><span class="p">,</span> <span class="n">encode_chunked</span><span class="o">=</span><span class="n">encode_chunked</span><span class="p">)</span>
   <span class="mi">1273</span>


<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">client</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">_send_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message_body</span><span class="p">,</span> <span class="n">encode_chunked</span><span class="p">)</span>
   <span class="mi">1031</span>         <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[:]</span>
<span class="o">-&gt;</span> <span class="mi">1032</span>         <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
   <span class="mi">1033</span>


<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">client</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
    <span class="mi">971</span>             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">auto_open</span><span class="p">:</span>
<span class="o">--&gt;</span> <span class="mi">972</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="mi">973</span>             <span class="k">else</span><span class="p">:</span>


<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">urllib3</span><span class="o">/</span><span class="n">connection</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="mi">186</span>     <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="o">--&gt;</span> <span class="mi">187</span>         <span class="n">conn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_new_conn</span><span class="p">()</span>
    <span class="mi">188</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_conn</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span>


<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">urllib3</span><span class="o">/</span><span class="n">connection</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">_new_conn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="mi">171</span>             <span class="k">raise</span> <span class="n">NewConnectionError</span><span class="p">(</span>
<span class="o">--&gt;</span> <span class="mi">172</span>                 <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Failed to establish a new connection: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">e</span>
    <span class="mi">173</span>             <span class="p">)</span>


<span class="n">NewConnectionError</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">urllib3</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">HTTPConnection</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7f4ee65894d0</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Failed</span> <span class="n">to</span> <span class="n">establish</span> <span class="n">a</span> <span class="n">new</span> <span class="n">connection</span><span class="p">:</span> <span class="p">[</span><span class="n">Errno</span> <span class="mi">111</span><span class="p">]</span> <span class="n">Connection</span> <span class="n">refused</span>


<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>


<span class="n">MaxRetryError</span>                             <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">requests</span><span class="o">/</span><span class="n">adapters</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">stream</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">verify</span><span class="p">,</span> <span class="n">cert</span><span class="p">,</span> <span class="n">proxies</span><span class="p">)</span>
    <span class="mi">448</span>                     <span class="n">retries</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_retries</span><span class="p">,</span>
<span class="o">--&gt;</span> <span class="mi">449</span>                     <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span>
    <span class="mi">450</span>                 <span class="p">)</span>


<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">urllib3</span><span class="o">/</span><span class="n">connectionpool</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">urlopen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">retries</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">assert_same_host</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">pool_timeout</span><span class="p">,</span> <span class="n">release_conn</span><span class="p">,</span> <span class="n">chunked</span><span class="p">,</span> <span class="n">body_pos</span><span class="p">,</span> <span class="o">**</span><span class="n">response_kw</span><span class="p">)</span>
    <span class="mi">724</span>             <span class="n">retries</span> <span class="o">=</span> <span class="n">retries</span><span class="o">.</span><span class="n">increment</span><span class="p">(</span>
<span class="o">--&gt;</span> <span class="mi">725</span>                 <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">e</span><span class="p">,</span> <span class="n">_pool</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">_stacktrace</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
    <span class="mi">726</span>             <span class="p">)</span>


<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">urllib3</span><span class="o">/</span><span class="n">util</span><span class="o">/</span><span class="n">retry</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">increment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">_pool</span><span class="p">,</span> <span class="n">_stacktrace</span><span class="p">)</span>
    <span class="mi">438</span>         <span class="k">if</span> <span class="n">new_retry</span><span class="o">.</span><span class="n">is_exhausted</span><span class="p">():</span>
<span class="o">--&gt;</span> <span class="mi">439</span>             <span class="k">raise</span> <span class="n">MaxRetryError</span><span class="p">(</span><span class="n">_pool</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">error</span> <span class="ow">or</span> <span class="n">ResponseError</span><span class="p">(</span><span class="n">cause</span><span class="p">))</span>
    <span class="mi">440</span>


<span class="n">MaxRetryError</span><span class="p">:</span> <span class="n">HTTPConnectionPool</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8000</span><span class="p">):</span> <span class="n">Max</span> <span class="n">retries</span> <span class="n">exceeded</span> <span class="k">with</span> <span class="n">url</span><span class="p">:</span> <span class="o">/</span><span class="n">api</span><span class="o">-</span><span class="n">token</span><span class="o">-</span><span class="n">auth</span><span class="o">/</span> <span class="p">(</span><span class="n">Caused</span> <span class="n">by</span> <span class="n">NewConnectionError</span><span class="p">(</span><span class="s1">&#39;&lt;urllib3.connection.HTTPConnection object at 0x7f4ee65894d0&gt;: Failed to establish a new connection: [Errno 111] Connection refused&#39;</span><span class="p">))</span>


<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>


<span class="ne">ConnectionError</span>                           <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">~/</span><span class="n">Dev</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">query</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">get_authentication_headers</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">api_base</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
    <span class="mi">153</span>         <span class="k">try</span><span class="p">:</span>
<span class="o">--&gt;</span> <span class="mi">154</span>             <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">auth_token_url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">auth_dict</span><span class="p">)</span>
    <span class="mi">155</span>         <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ConnectionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>


<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">requests</span><span class="o">/</span><span class="n">api</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">json</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="mi">118</span>
<span class="o">--&gt;</span> <span class="mi">119</span>     <span class="k">return</span> <span class="n">request</span><span class="p">(</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">json</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="mi">120</span>


<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">requests</span><span class="o">/</span><span class="n">api</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
     <span class="mi">60</span>     <span class="k">with</span> <span class="n">sessions</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
<span class="o">---&gt;</span> <span class="mi">61</span>         <span class="k">return</span> <span class="n">session</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
     <span class="mi">62</span>


<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">requests</span><span class="o">/</span><span class="n">sessions</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">cookies</span><span class="p">,</span> <span class="n">files</span><span class="p">,</span> <span class="n">auth</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="p">,</span> <span class="n">proxies</span><span class="p">,</span> <span class="n">hooks</span><span class="p">,</span> <span class="n">stream</span><span class="p">,</span> <span class="n">verify</span><span class="p">,</span> <span class="n">cert</span><span class="p">,</span> <span class="n">json</span><span class="p">)</span>
    <span class="mi">529</span>         <span class="n">send_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
<span class="o">--&gt;</span> <span class="mi">530</span>         <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">prep</span><span class="p">,</span> <span class="o">**</span><span class="n">send_kwargs</span><span class="p">)</span>
    <span class="mi">531</span>


<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">requests</span><span class="o">/</span><span class="n">sessions</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="mi">642</span>         <span class="c1"># Send the request</span>
<span class="o">--&gt;</span> <span class="mi">643</span>         <span class="n">r</span> <span class="o">=</span> <span class="n">adapter</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="mi">644</span>


<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">requests</span><span class="o">/</span><span class="n">adapters</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">stream</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">verify</span><span class="p">,</span> <span class="n">cert</span><span class="p">,</span> <span class="n">proxies</span><span class="p">)</span>
    <span class="mi">515</span>
<span class="o">--&gt;</span> <span class="mi">516</span>             <span class="k">raise</span> <span class="ne">ConnectionError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="mi">517</span>


<span class="ne">ConnectionError</span><span class="p">:</span> <span class="n">HTTPConnectionPool</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8000</span><span class="p">):</span> <span class="n">Max</span> <span class="n">retries</span> <span class="n">exceeded</span> <span class="k">with</span> <span class="n">url</span><span class="p">:</span> <span class="o">/</span><span class="n">api</span><span class="o">-</span><span class="n">token</span><span class="o">-</span><span class="n">auth</span><span class="o">/</span> <span class="p">(</span><span class="n">Caused</span> <span class="n">by</span> <span class="n">NewConnectionError</span><span class="p">(</span><span class="s1">&#39;&lt;urllib3.connection.HTTPConnection object at 0x7f4ee65894d0&gt;: Failed to establish a new connection: [Errno 111] Connection refused&#39;</span><span class="p">))</span>


<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>


<span class="n">InvalidURL</span>                                <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">a554c0550ac3</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
     <span class="mi">12</span>     <span class="nb">setattr</span><span class="p">(</span><span class="n">pkfilter</span><span class="p">,</span> <span class="n">df_key</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;study_name__in&quot;</span><span class="p">:</span> <span class="n">url_study_names</span><span class="p">})</span>
     <span class="mi">13</span>
<span class="o">---&gt;</span> <span class="mi">14</span> <span class="n">data</span> <span class="o">=</span> <span class="n">PKDB</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">pkfilter</span><span class="p">)</span>
     <span class="mi">15</span> <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>


<span class="o">~/</span><span class="n">Dev</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">query</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">query</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">pkfilter</span><span class="p">)</span>
    <span class="mi">121</span>
    <span class="mi">122</span>         <span class="n">url</span> <span class="o">=</span> <span class="n">API_URL</span> <span class="o">+</span> <span class="s2">&quot;/filter/&quot;</span> <span class="o">+</span> <span class="n">pkfilter</span><span class="o">.</span><span class="n">url_params</span>
<span class="o">--&gt;</span> <span class="mi">123</span>         <span class="n">headers</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_authentication_headers</span><span class="p">(</span><span class="n">BASE_URL</span><span class="p">,</span> <span class="n">USER</span><span class="p">,</span> <span class="n">PASSWORD</span><span class="p">)</span>
    <span class="mi">124</span>         <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="mi">125</span>


<span class="o">~/</span><span class="n">Dev</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">query</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">get_authentication_headers</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">api_base</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
    <span class="mi">155</span>         <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ConnectionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="mi">156</span>             <span class="k">raise</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">InvalidURL</span><span class="p">(</span>
<span class="o">--&gt;</span> <span class="mi">157</span>                 <span class="sa">f</span><span class="s2">&quot;Error Connecting (probably wrong url &lt;</span><span class="si">{</span><span class="n">api_base</span><span class="si">}</span><span class="s2">&gt;): &quot;</span><span class="p">,</span> <span class="n">e</span>
    <span class="mi">158</span>             <span class="p">)</span>
    <span class="mi">159</span>


<span class="n">InvalidURL</span><span class="p">:</span> <span class="p">[</span><span class="n">Errno</span> <span class="n">Error</span> <span class="n">Connecting</span> <span class="p">(</span><span class="n">probably</span> <span class="n">wrong</span> <span class="n">url</span> <span class="o">&lt;</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">8000</span><span class="o">&gt;</span><span class="p">):</span> <span class="p">]</span> <span class="n">HTTPConnectionPool</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8000</span><span class="p">):</span> <span class="n">Max</span> <span class="n">retries</span> <span class="n">exceeded</span> <span class="k">with</span> <span class="n">url</span><span class="p">:</span> <span class="o">/</span><span class="n">api</span><span class="o">-</span><span class="n">token</span><span class="o">-</span><span class="n">auth</span><span class="o">/</span> <span class="p">(</span><span class="n">Caused</span> <span class="n">by</span> <span class="n">NewConnectionError</span><span class="p">(</span><span class="s1">&#39;&lt;urllib3.connection.HTTPConnection object at 0x7f4ee65894d0&gt;: Failed to establish a new connection: [Errno 111] Connection refused&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">PKDB</span><span class="o">.</span><span class="n">query</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">ConnectionRefusedError</span>                    <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">urllib3</span><span class="o">/</span><span class="n">connection</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">_new_conn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="mi">159</span>             <span class="n">conn</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">create_connection</span><span class="p">(</span>
<span class="o">--&gt;</span> <span class="mi">160</span>                 <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dns_host</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">,</span> <span class="o">**</span><span class="n">extra_kw</span>
    <span class="mi">161</span>             <span class="p">)</span>


<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">urllib3</span><span class="o">/</span><span class="n">util</span><span class="o">/</span><span class="n">connection</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">create_connection</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">source_address</span><span class="p">,</span> <span class="n">socket_options</span><span class="p">)</span>
     <span class="mi">83</span>     <span class="k">if</span> <span class="n">err</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="o">---&gt;</span> <span class="mi">84</span>         <span class="k">raise</span> <span class="n">err</span>
     <span class="mi">85</span>


<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">urllib3</span><span class="o">/</span><span class="n">util</span><span class="o">/</span><span class="n">connection</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">create_connection</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">source_address</span><span class="p">,</span> <span class="n">socket_options</span><span class="p">)</span>
     <span class="mi">73</span>                 <span class="n">sock</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">source_address</span><span class="p">)</span>
<span class="o">---&gt;</span> <span class="mi">74</span>             <span class="n">sock</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">sa</span><span class="p">)</span>
     <span class="mi">75</span>             <span class="k">return</span> <span class="n">sock</span>


<span class="ne">ConnectionRefusedError</span><span class="p">:</span> <span class="p">[</span><span class="n">Errno</span> <span class="mi">111</span><span class="p">]</span> <span class="n">Connection</span> <span class="n">refused</span>


<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>


<span class="n">NewConnectionError</span>                        <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">urllib3</span><span class="o">/</span><span class="n">connectionpool</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">urlopen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">retries</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">assert_same_host</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">pool_timeout</span><span class="p">,</span> <span class="n">release_conn</span><span class="p">,</span> <span class="n">chunked</span><span class="p">,</span> <span class="n">body_pos</span><span class="p">,</span> <span class="o">**</span><span class="n">response_kw</span><span class="p">)</span>
    <span class="mi">676</span>                 <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
<span class="o">--&gt;</span> <span class="mi">677</span>                 <span class="n">chunked</span><span class="o">=</span><span class="n">chunked</span><span class="p">,</span>
    <span class="mi">678</span>             <span class="p">)</span>


<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">urllib3</span><span class="o">/</span><span class="n">connectionpool</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">_make_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conn</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">chunked</span><span class="p">,</span> <span class="o">**</span><span class="n">httplib_request_kw</span><span class="p">)</span>
    <span class="mi">391</span>         <span class="k">else</span><span class="p">:</span>
<span class="o">--&gt;</span> <span class="mi">392</span>             <span class="n">conn</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">httplib_request_kw</span><span class="p">)</span>
    <span class="mi">393</span>


<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">client</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">encode_chunked</span><span class="p">)</span>
   <span class="mi">1276</span>         <span class="s2">&quot;&quot;&quot;Send a complete request to the server.&quot;&quot;&quot;</span>
<span class="o">-&gt;</span> <span class="mi">1277</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_send_request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">encode_chunked</span><span class="p">)</span>
   <span class="mi">1278</span>


<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">client</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">_send_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">encode_chunked</span><span class="p">)</span>
   <span class="mi">1322</span>             <span class="n">body</span> <span class="o">=</span> <span class="n">_encode</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="s1">&#39;body&#39;</span><span class="p">)</span>
<span class="o">-&gt;</span> <span class="mi">1323</span>         <span class="bp">self</span><span class="o">.</span><span class="n">endheaders</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="n">encode_chunked</span><span class="o">=</span><span class="n">encode_chunked</span><span class="p">)</span>
   <span class="mi">1324</span>


<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">client</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">endheaders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message_body</span><span class="p">,</span> <span class="n">encode_chunked</span><span class="p">)</span>
   <span class="mi">1271</span>             <span class="k">raise</span> <span class="n">CannotSendHeader</span><span class="p">()</span>
<span class="o">-&gt;</span> <span class="mi">1272</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_send_output</span><span class="p">(</span><span class="n">message_body</span><span class="p">,</span> <span class="n">encode_chunked</span><span class="o">=</span><span class="n">encode_chunked</span><span class="p">)</span>
   <span class="mi">1273</span>


<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">client</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">_send_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message_body</span><span class="p">,</span> <span class="n">encode_chunked</span><span class="p">)</span>
   <span class="mi">1031</span>         <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[:]</span>
<span class="o">-&gt;</span> <span class="mi">1032</span>         <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
   <span class="mi">1033</span>


<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">client</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
    <span class="mi">971</span>             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">auto_open</span><span class="p">:</span>
<span class="o">--&gt;</span> <span class="mi">972</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="mi">973</span>             <span class="k">else</span><span class="p">:</span>


<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">urllib3</span><span class="o">/</span><span class="n">connection</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="mi">186</span>     <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="o">--&gt;</span> <span class="mi">187</span>         <span class="n">conn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_new_conn</span><span class="p">()</span>
    <span class="mi">188</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_conn</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span>


<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">urllib3</span><span class="o">/</span><span class="n">connection</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">_new_conn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="mi">171</span>             <span class="k">raise</span> <span class="n">NewConnectionError</span><span class="p">(</span>
<span class="o">--&gt;</span> <span class="mi">172</span>                 <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Failed to establish a new connection: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">e</span>
    <span class="mi">173</span>             <span class="p">)</span>


<span class="n">NewConnectionError</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">urllib3</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">HTTPConnection</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7f4f1c3dd750</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Failed</span> <span class="n">to</span> <span class="n">establish</span> <span class="n">a</span> <span class="n">new</span> <span class="n">connection</span><span class="p">:</span> <span class="p">[</span><span class="n">Errno</span> <span class="mi">111</span><span class="p">]</span> <span class="n">Connection</span> <span class="n">refused</span>


<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>


<span class="n">MaxRetryError</span>                             <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">requests</span><span class="o">/</span><span class="n">adapters</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">stream</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">verify</span><span class="p">,</span> <span class="n">cert</span><span class="p">,</span> <span class="n">proxies</span><span class="p">)</span>
    <span class="mi">448</span>                     <span class="n">retries</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_retries</span><span class="p">,</span>
<span class="o">--&gt;</span> <span class="mi">449</span>                     <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span>
    <span class="mi">450</span>                 <span class="p">)</span>


<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">urllib3</span><span class="o">/</span><span class="n">connectionpool</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">urlopen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">retries</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">assert_same_host</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">pool_timeout</span><span class="p">,</span> <span class="n">release_conn</span><span class="p">,</span> <span class="n">chunked</span><span class="p">,</span> <span class="n">body_pos</span><span class="p">,</span> <span class="o">**</span><span class="n">response_kw</span><span class="p">)</span>
    <span class="mi">724</span>             <span class="n">retries</span> <span class="o">=</span> <span class="n">retries</span><span class="o">.</span><span class="n">increment</span><span class="p">(</span>
<span class="o">--&gt;</span> <span class="mi">725</span>                 <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">e</span><span class="p">,</span> <span class="n">_pool</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">_stacktrace</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
    <span class="mi">726</span>             <span class="p">)</span>


<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">urllib3</span><span class="o">/</span><span class="n">util</span><span class="o">/</span><span class="n">retry</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">increment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">_pool</span><span class="p">,</span> <span class="n">_stacktrace</span><span class="p">)</span>
    <span class="mi">438</span>         <span class="k">if</span> <span class="n">new_retry</span><span class="o">.</span><span class="n">is_exhausted</span><span class="p">():</span>
<span class="o">--&gt;</span> <span class="mi">439</span>             <span class="k">raise</span> <span class="n">MaxRetryError</span><span class="p">(</span><span class="n">_pool</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">error</span> <span class="ow">or</span> <span class="n">ResponseError</span><span class="p">(</span><span class="n">cause</span><span class="p">))</span>
    <span class="mi">440</span>


<span class="n">MaxRetryError</span><span class="p">:</span> <span class="n">HTTPConnectionPool</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8000</span><span class="p">):</span> <span class="n">Max</span> <span class="n">retries</span> <span class="n">exceeded</span> <span class="k">with</span> <span class="n">url</span><span class="p">:</span> <span class="o">/</span><span class="n">api</span><span class="o">-</span><span class="n">token</span><span class="o">-</span><span class="n">auth</span><span class="o">/</span> <span class="p">(</span><span class="n">Caused</span> <span class="n">by</span> <span class="n">NewConnectionError</span><span class="p">(</span><span class="s1">&#39;&lt;urllib3.connection.HTTPConnection object at 0x7f4f1c3dd750&gt;: Failed to establish a new connection: [Errno 111] Connection refused&#39;</span><span class="p">))</span>


<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>


<span class="ne">ConnectionError</span>                           <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">~/</span><span class="n">Dev</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">query</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">get_authentication_headers</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">api_base</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
    <span class="mi">153</span>         <span class="k">try</span><span class="p">:</span>
<span class="o">--&gt;</span> <span class="mi">154</span>             <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">auth_token_url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">auth_dict</span><span class="p">)</span>
    <span class="mi">155</span>         <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ConnectionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>


<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">requests</span><span class="o">/</span><span class="n">api</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">json</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="mi">118</span>
<span class="o">--&gt;</span> <span class="mi">119</span>     <span class="k">return</span> <span class="n">request</span><span class="p">(</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">json</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="mi">120</span>


<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">requests</span><span class="o">/</span><span class="n">api</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
     <span class="mi">60</span>     <span class="k">with</span> <span class="n">sessions</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
<span class="o">---&gt;</span> <span class="mi">61</span>         <span class="k">return</span> <span class="n">session</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
     <span class="mi">62</span>


<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">requests</span><span class="o">/</span><span class="n">sessions</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">cookies</span><span class="p">,</span> <span class="n">files</span><span class="p">,</span> <span class="n">auth</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="p">,</span> <span class="n">proxies</span><span class="p">,</span> <span class="n">hooks</span><span class="p">,</span> <span class="n">stream</span><span class="p">,</span> <span class="n">verify</span><span class="p">,</span> <span class="n">cert</span><span class="p">,</span> <span class="n">json</span><span class="p">)</span>
    <span class="mi">529</span>         <span class="n">send_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
<span class="o">--&gt;</span> <span class="mi">530</span>         <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">prep</span><span class="p">,</span> <span class="o">**</span><span class="n">send_kwargs</span><span class="p">)</span>
    <span class="mi">531</span>


<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">requests</span><span class="o">/</span><span class="n">sessions</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="mi">642</span>         <span class="c1"># Send the request</span>
<span class="o">--&gt;</span> <span class="mi">643</span>         <span class="n">r</span> <span class="o">=</span> <span class="n">adapter</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="mi">644</span>


<span class="o">~/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">requests</span><span class="o">/</span><span class="n">adapters</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">stream</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">verify</span><span class="p">,</span> <span class="n">cert</span><span class="p">,</span> <span class="n">proxies</span><span class="p">)</span>
    <span class="mi">515</span>
<span class="o">--&gt;</span> <span class="mi">516</span>             <span class="k">raise</span> <span class="ne">ConnectionError</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">request</span><span class="o">=</span><span class="n">request</span><span class="p">)</span>
    <span class="mi">517</span>


<span class="ne">ConnectionError</span><span class="p">:</span> <span class="n">HTTPConnectionPool</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8000</span><span class="p">):</span> <span class="n">Max</span> <span class="n">retries</span> <span class="n">exceeded</span> <span class="k">with</span> <span class="n">url</span><span class="p">:</span> <span class="o">/</span><span class="n">api</span><span class="o">-</span><span class="n">token</span><span class="o">-</span><span class="n">auth</span><span class="o">/</span> <span class="p">(</span><span class="n">Caused</span> <span class="n">by</span> <span class="n">NewConnectionError</span><span class="p">(</span><span class="s1">&#39;&lt;urllib3.connection.HTTPConnection object at 0x7f4f1c3dd750&gt;: Failed to establish a new connection: [Errno 111] Connection refused&#39;</span><span class="p">))</span>


<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>


<span class="n">InvalidURL</span>                                <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="n">be0e0ad1b6b</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">data</span> <span class="o">=</span> <span class="n">PKDB</span><span class="o">.</span><span class="n">query</span><span class="p">()</span>


<span class="o">~/</span><span class="n">Dev</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">query</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">query</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">pkfilter</span><span class="p">)</span>
    <span class="mi">121</span>
    <span class="mi">122</span>         <span class="n">url</span> <span class="o">=</span> <span class="n">API_URL</span> <span class="o">+</span> <span class="s2">&quot;/filter/&quot;</span> <span class="o">+</span> <span class="n">pkfilter</span><span class="o">.</span><span class="n">url_params</span>
<span class="o">--&gt;</span> <span class="mi">123</span>         <span class="n">headers</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_authentication_headers</span><span class="p">(</span><span class="n">BASE_URL</span><span class="p">,</span> <span class="n">USER</span><span class="p">,</span> <span class="n">PASSWORD</span><span class="p">)</span>
    <span class="mi">124</span>         <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="mi">125</span>


<span class="o">~/</span><span class="n">Dev</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="n">query</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">get_authentication_headers</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">api_base</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
    <span class="mi">155</span>         <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ConnectionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="mi">156</span>             <span class="k">raise</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">InvalidURL</span><span class="p">(</span>
<span class="o">--&gt;</span> <span class="mi">157</span>                 <span class="sa">f</span><span class="s2">&quot;Error Connecting (probably wrong url &lt;</span><span class="si">{</span><span class="n">api_base</span><span class="si">}</span><span class="s2">&gt;): &quot;</span><span class="p">,</span> <span class="n">e</span>
    <span class="mi">158</span>             <span class="p">)</span>
    <span class="mi">159</span>


<span class="n">InvalidURL</span><span class="p">:</span> <span class="p">[</span><span class="n">Errno</span> <span class="n">Error</span> <span class="n">Connecting</span> <span class="p">(</span><span class="n">probably</span> <span class="n">wrong</span> <span class="n">url</span> <span class="o">&lt;</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">8000</span><span class="o">&gt;</span><span class="p">):</span> <span class="p">]</span> <span class="n">HTTPConnectionPool</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8000</span><span class="p">):</span> <span class="n">Max</span> <span class="n">retries</span> <span class="n">exceeded</span> <span class="k">with</span> <span class="n">url</span><span class="p">:</span> <span class="o">/</span><span class="n">api</span><span class="o">-</span><span class="n">token</span><span class="o">-</span><span class="n">auth</span><span class="o">/</span> <span class="p">(</span><span class="n">Caused</span> <span class="n">by</span> <span class="n">NewConnectionError</span><span class="p">(</span><span class="s1">&#39;&lt;urllib3.connection.HTTPConnection object at 0x7f4f1c3dd750&gt;: Failed to establish a new connection: [Errno 111] Connection refused&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="data_examples.html" class="btn btn-neutral float-right" title="Working with PK-DB data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../index.html" class="btn btn-neutral float-left" title="Welcome to PKDB’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019, Jan Grzegorzewski &amp; Matthias König

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>