

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Filter data &mdash; pkdb_analysis  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> pkdb_analysis
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="query_examples.html">Query PK-DB</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_examples.html">Working with PK-DB data</a></li>
<li class="toctree-l1"><a class="reference internal" href="filter_examples.html">Filter data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pkdb_analysis</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Filter data</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/filter_examples_1.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>

<span class="c1"># install pkdb_analysis via:</span>
<span class="c1">#     git clone https://github.com/matthiaskoenig/pkdb_analysis (private)</span>
<span class="c1">#     cd pkdb_analysis</span>
<span class="c1">#     pip install -e .</span>
<span class="c1"># in future:</span>
<span class="c1">#     pip install pkdb_analsis</span>

<span class="kn">from</span> <span class="nn">pkdb_analysis</span> <span class="kn">import</span> <span class="n">PKDB</span><span class="p">,</span> <span class="n">PKData</span><span class="p">,</span> <span class="n">PKFilter</span>
<span class="kn">from</span> <span class="nn">pkdb_analysis.test</span> <span class="kn">import</span> <span class="n">TESTDATA_CONCISE_FALSE_ZIP</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">janek</span><span class="o">/.</span><span class="n">virtualenvs</span><span class="o">/</span><span class="n">pkdb_analysis</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">python</span>
<span class="mf">3.7</span><span class="o">.</span><span class="mi">9</span> <span class="p">(</span><span class="n">default</span><span class="p">,</span> <span class="n">Aug</span> <span class="mi">18</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">02</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">21</span><span class="p">)</span>
<span class="p">[</span><span class="n">GCC</span> <span class="mf">9.3</span><span class="o">.</span><span class="mi">0</span><span class="p">]</span>
<span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">(</span><span class="n">major</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">minor</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">micro</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">releaselevel</span><span class="o">=</span><span class="s1">&#39;final&#39;</span><span class="p">,</span> <span class="n">serial</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="filter-data">
<h1>Filter data<a class="headerlink" href="#filter-data" title="Permalink to this headline">¶</a></h1>
<p>A recurring task is to filter data for a certain question. E.g. to
compare two groups, or get the subset of data for all healthy smokers.</p>
<p>We work again with our test data set and will filter various subsets
from it.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#test_data = PKDB.query()</span>
<span class="c1">#TEST_HDF5 =&quot;./test_data.hdf5&quot;</span>

<span class="n">test_data</span> <span class="o">=</span> <span class="n">PKData</span><span class="o">.</span><span class="n">from_archive</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">TESTDATA_CONCISE_FALSE_ZIP</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_data</span><span class="o">.</span><span class="n">_concise</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">------------------------------</span>
<span class="n">PKData</span> <span class="p">(</span><span class="mi">140200057729936</span><span class="p">)</span>
<span class="o">------------------------------</span>
<span class="n">studies</span>           <span class="mi">124</span>  <span class="p">(</span>  <span class="mi">124</span><span class="p">)</span>
<span class="n">groups</span>            <span class="mi">284</span>  <span class="p">(</span> <span class="mi">2613</span><span class="p">)</span>
<span class="n">individuals</span>      <span class="mi">3082</span>  <span class="p">(</span><span class="mi">27405</span><span class="p">)</span>
<span class="n">interventions</span>     <span class="mi">366</span>  <span class="p">(</span>  <span class="mi">366</span><span class="p">)</span>
<span class="n">outputs</span>         <span class="mi">19407</span>  <span class="p">(</span><span class="mi">29053</span><span class="p">)</span>
<span class="n">timecourses</span>       <span class="mi">722</span>  <span class="p">(</span>  <span class="mi">722</span><span class="p">)</span>
<span class="n">scatters</span>           <span class="mi">80</span>  <span class="p">(</span>   <span class="mi">80</span><span class="p">)</span>
<span class="o">------------------------------</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_data1</span> <span class="o">=</span>  <span class="n">test_data</span><span class="o">.</span><span class="n">filter_study</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;licence&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;open&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">test_data1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">------------------------------</span>
<span class="n">PKData</span> <span class="p">(</span><span class="mi">140200057063312</span><span class="p">)</span>
<span class="o">------------------------------</span>
<span class="n">studies</span>            <span class="mi">12</span>  <span class="p">(</span>   <span class="mi">12</span><span class="p">)</span>
<span class="n">groups</span>            <span class="mi">284</span>  <span class="p">(</span> <span class="mi">2613</span><span class="p">)</span>
<span class="n">individuals</span>      <span class="mi">3082</span>  <span class="p">(</span><span class="mi">27405</span><span class="p">)</span>
<span class="n">interventions</span>     <span class="mi">366</span>  <span class="p">(</span>  <span class="mi">366</span><span class="p">)</span>
<span class="n">outputs</span>         <span class="mi">19407</span>  <span class="p">(</span><span class="mi">29053</span><span class="p">)</span>
<span class="n">timecourses</span>       <span class="mi">722</span>  <span class="p">(</span>  <span class="mi">722</span><span class="p">)</span>
<span class="n">scatters</span>           <span class="mi">80</span>  <span class="p">(</span>   <span class="mi">80</span><span class="p">)</span>
<span class="o">------------------------------</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">test_data</span><span class="o">.</span><span class="n">study_sids</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;PKDB00013&#39;</span><span class="p">,</span>
 <span class="s1">&#39;26862045&#39;</span><span class="p">,</span>
 <span class="s1">&#39;10634135&#39;</span><span class="p">,</span>
 <span class="s1">&#39;4027137&#39;</span><span class="p">,</span>
 <span class="s1">&#39;PKDB00011&#39;</span><span class="p">,</span>
 <span class="s1">&#39;PKDB00042&#39;</span><span class="p">,</span>
 <span class="s1">&#39;PKDB00045&#39;</span><span class="p">,</span>
 <span class="s1">&#39;13053413&#39;</span><span class="p">,</span>
 <span class="s1">&#39;PKDB00008&#39;</span><span class="p">,</span>
 <span class="s1">&#39;PKDB00036&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="section" id="filter-functions">
<h2>Filter functions<a class="headerlink" href="#filter-functions" title="Permalink to this headline">¶</a></h2>
<p>The main principle for filtering <code class="docutils literal notranslate"><span class="pre">PKData</span></code> is by using the <code class="docutils literal notranslate"><span class="pre">filter_*</span></code>
and <code class="docutils literal notranslate"><span class="pre">exclude_*</span></code> functionality.</p>
<p>A key principle are hereby filter functions which for a given DataFrame
return a logical index.</p>
<p>Depending on which subset of information this should be applied the
<code class="docutils literal notranslate"><span class="pre">groups</span></code>, <code class="docutils literal notranslate"><span class="pre">individuals</span></code>, <code class="docutils literal notranslate"><span class="pre">subjects</span></code> (groups and individuals),
<code class="docutils literal notranslate"><span class="pre">outputs</span></code> and <code class="docutils literal notranslate"><span class="pre">timecourses</span></code>.</p>
</div>
<div class="section" id="filter-by-study-sid">
<h2>Filter by <code class="docutils literal notranslate"><span class="pre">study_sid</span></code><a class="headerlink" href="#filter-by-study-sid" title="Permalink to this headline">¶</a></h2>
<p>A first example is filtering by <code class="docutils literal notranslate"><span class="pre">study_sid</span></code>, i.e. we only want the
subset of data from a single study. An overview over the existing study
sids in the dataset is available via</p>
<p>Filtering a subset of data works by providing filter/selection functions
which select a subset of the data. The filters are written on the
<code class="docutils literal notranslate"><span class="pre">groups</span></code>, <code class="docutils literal notranslate"><span class="pre">individuals</span></code></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">is_PKDB99999</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Filter for specific study_sid. &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">d</span><span class="o">.</span><span class="n">study_sid</span> <span class="o">==</span> <span class="s2">&quot;PKDB00198&quot;</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">filter_intervention</span><span class="p">(</span><span class="n">is_PKDB99999</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">------------------------------</span>
<span class="n">PKData</span> <span class="p">(</span><span class="mi">140200051078672</span><span class="p">)</span>
<span class="o">------------------------------</span>
<span class="n">studies</span>             <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">groups</span>              <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">individuals</span>         <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">interventions</span>       <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">outputs</span>             <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">timecourses</span>         <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">scatters</span>           <span class="mi">80</span>  <span class="p">(</span>   <span class="mi">80</span><span class="p">)</span>
<span class="o">------------------------------</span>
</pre></div>
</div>
<p>The PKData now only contains data for the given study_sid:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">study_sids</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;7371463&#39;</span><span class="p">,</span> <span class="s1">&#39;26862045&#39;</span><span class="p">,</span> <span class="s1">&#39;4027137&#39;</span><span class="p">,</span> <span class="s1">&#39;3557314&#39;</span><span class="p">,</span> <span class="s1">&#39;2921843&#39;</span><span class="p">,</span> <span class="s1">&#39;PKDB00045&#39;</span><span class="p">,</span> <span class="s1">&#39;25891161&#39;</span><span class="p">,</span> <span class="s1">&#39;2185297&#39;</span><span class="p">,</span> <span class="s1">&#39;Sandberg1988&#39;</span><span class="p">,</span> <span class="s1">&#39;25853045&#39;</span><span class="p">,</span> <span class="s1">&#39;PKDB00126&#39;</span><span class="p">,</span> <span class="s1">&#39;Nakazawa1988&#39;</span><span class="p">,</span> <span class="s1">&#39;PKDB00012&#39;</span><span class="p">,</span> <span class="s1">&#39;Lennard1982&#39;</span><span class="p">,</span> <span class="s1">&#39;15022032&#39;</span><span class="p">,</span> <span class="s1">&#39;6712142&#39;</span><span class="p">,</span> <span class="s1">&#39;28929443&#39;</span><span class="p">,</span> <span class="s1">&#39;1033273&#39;</span><span class="p">,</span> <span class="s1">&#39;PKDB00015&#39;</span><span class="p">,</span> <span class="s1">&#39;PKDB00210&#39;</span><span class="p">,</span> <span class="s1">&#39;PKDB00002&#39;</span><span class="p">,</span> <span class="s1">&#39;Trang1985&#39;</span><span class="p">}</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># for instance interventions</span>
<span class="n">display</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">interventions</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>study_sid</th>
      <th>study_name</th>
      <th>intervention_pk</th>
      <th>raw_pk</th>
      <th>normed</th>
      <th>name</th>
      <th>route</th>
      <th>route_label</th>
      <th>form</th>
      <th>...</th>
      <th>substance_label</th>
      <th>value</th>
      <th>mean</th>
      <th>median</th>
      <th>min</th>
      <th>max</th>
      <th>sd</th>
      <th>se</th>
      <th>cv</th>
      <th>unit</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
<p>0 rows × 31 columns</p>
</div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Empty</span> <span class="n">DataFrame</span>
<span class="n">Columns</span><span class="p">:</span> <span class="p">[</span><span class="n">Unnamed</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">study_sid</span><span class="p">,</span> <span class="n">study_name</span><span class="p">,</span> <span class="n">intervention_pk</span><span class="p">,</span> <span class="n">raw_pk</span><span class="p">,</span> <span class="n">normed</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">route</span><span class="p">,</span> <span class="n">route_label</span><span class="p">,</span> <span class="n">form</span><span class="p">,</span> <span class="n">form_label</span><span class="p">,</span> <span class="n">application</span><span class="p">,</span> <span class="n">application_label</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">time_end</span><span class="p">,</span> <span class="n">time_unit</span><span class="p">,</span> <span class="n">measurement_type</span><span class="p">,</span> <span class="n">measurement_type_label</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">choice_label</span><span class="p">,</span> <span class="n">substance</span><span class="p">,</span> <span class="n">substance_label</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="n">sd</span><span class="p">,</span> <span class="n">se</span><span class="p">,</span> <span class="n">cv</span><span class="p">,</span> <span class="n">unit</span><span class="p">]</span>
<span class="n">Index</span><span class="p">:</span> <span class="p">[]</span>

<span class="p">[</span><span class="mi">0</span> <span class="n">rows</span> <span class="n">x</span> <span class="mi">31</span> <span class="n">columns</span><span class="p">]</span>
</pre></div>
</div>
<p>One could also define this as a simple lambda function</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">filter_intervention</span><span class="p">(</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="o">.</span><span class="n">study_sid</span> <span class="o">==</span> <span class="s2">&quot;PKDB00198&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">------------------------------</span>
<span class="n">PKData</span> <span class="p">(</span><span class="mi">140200047715280</span><span class="p">)</span>
<span class="o">------------------------------</span>
<span class="n">studies</span>             <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">groups</span>              <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">individuals</span>         <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">interventions</span>       <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">outputs</span>             <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">timecourses</span>         <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">scatters</span>           <span class="mi">80</span>  <span class="p">(</span>   <span class="mi">80</span><span class="p">)</span>
<span class="o">------------------------------</span>
</pre></div>
</div>
</div>
<div class="section" id="concise-data">
<h2>Concise data<a class="headerlink" href="#concise-data" title="Permalink to this headline">¶</a></h2>
<p>All operations on <code class="docutils literal notranslate"><span class="pre">PKData</span></code> leave the data in a consistent manner. E.g.
if an intervention is filtered out also all the outputs using this
intervention are filtered out. This behavior is controlled by the
<code class="docutils literal notranslate"><span class="pre">concise</span></code> flag on most operations.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t1</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">filter_intervention</span><span class="p">(</span><span class="n">is_PKDB99999</span><span class="p">)</span>
<span class="n">t2</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">filter_intervention</span><span class="p">(</span><span class="n">is_PKDB99999</span><span class="p">,</span> <span class="n">concise</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">------------------------------</span>
<span class="n">PKData</span> <span class="p">(</span><span class="mi">140200067512720</span><span class="p">)</span>
<span class="o">------------------------------</span>
<span class="n">studies</span>             <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">groups</span>              <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">individuals</span>         <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">interventions</span>       <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">outputs</span>             <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">timecourses</span>         <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">scatters</span>           <span class="mi">80</span>  <span class="p">(</span>   <span class="mi">80</span><span class="p">)</span>
<span class="o">------------------------------</span>
<span class="o">------------------------------</span>
<span class="n">PKData</span> <span class="p">(</span><span class="mi">140200047779152</span><span class="p">)</span>
<span class="o">------------------------------</span>
<span class="n">studies</span>           <span class="mi">124</span>  <span class="p">(</span>  <span class="mi">124</span><span class="p">)</span>
<span class="n">groups</span>            <span class="mi">284</span>  <span class="p">(</span> <span class="mi">2613</span><span class="p">)</span>
<span class="n">individuals</span>      <span class="mi">3082</span>  <span class="p">(</span><span class="mi">27405</span><span class="p">)</span>
<span class="n">interventions</span>       <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">outputs</span>         <span class="mi">19407</span>  <span class="p">(</span><span class="mi">29053</span><span class="p">)</span>
<span class="n">timecourses</span>       <span class="mi">722</span>  <span class="p">(</span>  <span class="mi">722</span><span class="p">)</span>
<span class="n">scatters</span>           <span class="mi">80</span>  <span class="p">(</span>   <span class="mi">80</span><span class="p">)</span>
<span class="o">------------------------------</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># FIXME: only normed data</span>
<span class="n">t1</span><span class="o">.</span><span class="n">interventions_mi</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2</span><span class="o">.</span><span class="n">interventions_mi</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2</span><span class="o">.</span><span class="n">outputs</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>study_name</th>
      <th>measurement_type</th>
      <th>tissue</th>
      <th>sd</th>
      <th>se</th>
      <th>min</th>
      <th>group_pk</th>
      <th>output_pk</th>
      <th>time_unit</th>
      <th>...</th>
      <th>max</th>
      <th>substance</th>
      <th>label</th>
      <th>individual_pk</th>
      <th>unit</th>
      <th>cv</th>
      <th>median</th>
      <th>mean</th>
      <th>time</th>
      <th>choice</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Abernethy1985</td>
      <td>thalf</td>
      <td>plasma</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1</td>
      <td>210625</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>caf</td>
      <td>NaN</td>
      <td>23952</td>
      <td>hour</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Abernethy1985</td>
      <td>thalf</td>
      <td>plasma</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1</td>
      <td>210628</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>caf</td>
      <td>NaN</td>
      <td>23955</td>
      <td>hour</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Abernethy1985</td>
      <td>thalf</td>
      <td>plasma</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1</td>
      <td>210631</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>caf</td>
      <td>NaN</td>
      <td>23958</td>
      <td>hour</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>Abernethy1985</td>
      <td>thalf</td>
      <td>plasma</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1</td>
      <td>210635</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>caf</td>
      <td>NaN</td>
      <td>23962</td>
      <td>hour</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Abernethy1985</td>
      <td>clearance</td>
      <td>plasma</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1</td>
      <td>210640</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>caf</td>
      <td>NaN</td>
      <td>23967</td>
      <td>liter / hour / kilogram</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>29048</th>
      <td>29048</td>
      <td>Barnett1990</td>
      <td>cmax</td>
      <td>plasma</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1</td>
      <td>263142</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>caf</td>
      <td>NaN</td>
      <td>30567</td>
      <td>gram / liter</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>29049</th>
      <td>29049</td>
      <td>Barnett1990</td>
      <td>vd-ss</td>
      <td>plasma</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1</td>
      <td>263146</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>caf</td>
      <td>NaN</td>
      <td>30567</td>
      <td>liter</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>29050</th>
      <td>29050</td>
      <td>Barnett1990</td>
      <td>cmax</td>
      <td>plasma</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1</td>
      <td>263159</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>caf</td>
      <td>NaN</td>
      <td>30567</td>
      <td>gram / liter</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>29051</th>
      <td>29051</td>
      <td>Barnett1990</td>
      <td>vd</td>
      <td>plasma</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1</td>
      <td>263163</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>caf</td>
      <td>NaN</td>
      <td>30567</td>
      <td>liter</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>29052</th>
      <td>29052</td>
      <td>Barnett1990</td>
      <td>vd-ss</td>
      <td>plasma</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1</td>
      <td>263164</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>caf</td>
      <td>NaN</td>
      <td>30567</td>
      <td>liter</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>29053 rows × 27 columns</p>
</div><pre class="literal-block">       Unnamed: 0     study_name measurement_type  tissue  sd  se  min  0               0  Abernethy1985            thalf  plasma NaN NaN  NaN
1               1  Abernethy1985            thalf  plasma NaN NaN  NaN
2               2  Abernethy1985            thalf  plasma NaN NaN  NaN
3               3  Abernethy1985            thalf  plasma NaN NaN  NaN
4               4  Abernethy1985        clearance  plasma NaN NaN  NaN
...           ...            ...              ...     ...  ..  ..  ...
29048       29048    Barnett1990             cmax  plasma NaN NaN  NaN
29049       29049    Barnett1990            vd-ss  plasma NaN NaN  NaN
29050       29050    Barnett1990             cmax  plasma NaN NaN  NaN
29051       29051    Barnett1990               vd  plasma NaN NaN  NaN
29052       29052    Barnett1990            vd-ss  plasma NaN NaN  NaN

       group_pk  output_pk time_unit  ...  max  substance  label  0            -1     210625       NaN  ...  NaN        caf    NaN
1            -1     210628       NaN  ...  NaN        caf    NaN
2            -1     210631       NaN  ...  NaN        caf    NaN
3            -1     210635       NaN  ...  NaN        caf    NaN
4            -1     210640       NaN  ...  NaN        caf    NaN
...         ...        ...       ...  ...  ...        ...    ...
29048        -1     263142       NaN  ...  NaN        caf    NaN
29049        -1     263146       NaN  ...  NaN        caf    NaN
29050        -1     263159       NaN  ...  NaN        caf    NaN
29051        -1     263163       NaN  ...  NaN        caf    NaN
29052        -1     263164       NaN  ...  NaN        caf    NaN

      individual_pk                     unit  cv median  mean time choice
0             23952                     hour NaN    NaN   NaN  NaN    NaN
1             23955                     hour NaN    NaN   NaN  NaN    NaN
2             23958                     hour NaN    NaN   NaN  NaN    NaN
3             23962                     hour NaN    NaN   NaN  NaN    NaN
4             23967  liter / hour / kilogram NaN    NaN   NaN  NaN    NaN
...             ...                      ...  ..    ...   ...  ...    ...
29048         30567             gram / liter NaN    NaN   NaN  NaN    NaN
29049         30567                    liter NaN    NaN   NaN  NaN    NaN
29050         30567             gram / liter NaN    NaN   NaN  NaN    NaN
29051         30567                    liter NaN    NaN   NaN  NaN    NaN
29052         30567                    liter NaN    NaN   NaN  NaN    NaN

[29053 rows x 27 columns]</pre>
</div>
<div class="section" id="query-groups-and-individuals">
<h2>Query groups and individuals<a class="headerlink" href="#query-groups-and-individuals" title="Permalink to this headline">¶</a></h2>
<div class="section" id="get-data-for-groups-with-characteristica-keywords-x">
<h3>2.1 Get data for groups with characteristica/keywords X<a class="headerlink" href="#get-data-for-groups-with-characteristica-keywords-x" title="Permalink to this headline">¶</a></h3>
<p>healthy=True, smoking=N, disease=None, individual queries and
combinations.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">is_healthy</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="c1"># healthy is reported and True</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">measurement_type</span> <span class="o">==</span> <span class="s2">&quot;healthy&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">choice</span> <span class="o">==</span> <span class="s2">&quot;Y&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">disease</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="c1"># any disease is reported</span>
    <span class="k">return</span>  <span class="n">d</span><span class="o">.</span><span class="n">measurement_type</span> <span class="o">==</span> <span class="s2">&quot;disease&quot;</span>

<span class="k">def</span> <span class="nf">smoking</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="c1"># smoking status is curated for study (this could by Y/N/NR)</span>
    <span class="k">return</span>  <span class="n">d</span><span class="o">.</span><span class="n">measurement_type</span> <span class="o">==</span> <span class="s2">&quot;smoking&quot;</span>

<span class="k">def</span> <span class="nf">nonsmoker</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="c1"># smoking is reported and no</span>
    <span class="k">return</span> <span class="n">smoking</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">choice</span> <span class="o">==</span> <span class="s2">&quot;N&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">smoker</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="c1"># smoking is reported and yes</span>
    <span class="k">return</span> <span class="n">smoking</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">choice</span> <span class="o">==</span> <span class="s2">&quot;Y&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_data</span> <span class="o">=</span> <span class="n">PKData</span><span class="o">.</span><span class="n">from_archive</span><span class="p">(</span><span class="n">TESTDATA_CONCISE_FALSE_ZIP</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">f_idx</span></code> can be a single function, or a list of functions. A list of
functions are applied successively and is equivalent to “AND logic”. “OR
logic” can be directly applied on the index.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">healthy_nonsmoker</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">filter_subject</span><span class="p">(</span><span class="n">f_idx</span><span class="o">=</span><span class="p">[</span><span class="n">is_healthy</span><span class="p">,</span> <span class="n">nonsmoker</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">healthy_nonsmoker</span><span class="p">)</span>
<span class="n">healthy_nonsmoker</span><span class="o">.</span><span class="n">groups_mi</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">------------------------------</span>
<span class="n">PKData</span> <span class="p">(</span><span class="mi">140200056602832</span><span class="p">)</span>
<span class="o">------------------------------</span>
<span class="n">studies</span>            <span class="mi">81</span>  <span class="p">(</span>   <span class="mi">81</span><span class="p">)</span>
<span class="n">groups</span>            <span class="mi">143</span>  <span class="p">(</span> <span class="mi">1396</span><span class="p">)</span>
<span class="n">individuals</span>      <span class="mi">1150</span>  <span class="p">(</span><span class="mi">10810</span><span class="p">)</span>
<span class="n">interventions</span>     <span class="mi">238</span>  <span class="p">(</span>  <span class="mi">238</span><span class="p">)</span>
<span class="n">outputs</span>         <span class="mi">10578</span>  <span class="p">(</span><span class="mi">14843</span><span class="p">)</span>
<span class="n">timecourses</span>       <span class="mi">438</span>  <span class="p">(</span>  <span class="mi">438</span><span class="p">)</span>
<span class="n">scatters</span>           <span class="mi">80</span>  <span class="p">(</span>   <span class="mi">80</span><span class="p">)</span>
<span class="o">------------------------------</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Unnamed: 0</th>
      <th>study_name</th>
      <th>study_sid</th>
      <th>measurement_type</th>
      <th>group_count</th>
      <th>group_name</th>
      <th>max</th>
      <th>substance</th>
      <th>count</th>
      <th>group_parent_pk</th>
      <th>sd</th>
      <th>unit</th>
      <th>se</th>
      <th>min</th>
      <th>cv</th>
      <th>median</th>
      <th>mean</th>
      <th>choice</th>
      <th>value</th>
    </tr>
    <tr>
      <th>group_pk</th>
      <th>characteristica_pk</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">3463</th>
      <th>67383</th>
      <td>10</td>
      <td>Abernethy1985</td>
      <td>PKDB00001</td>
      <td>smoking</td>
      <td>9</td>
      <td>OCS</td>
      <td>NaN</td>
      <td>nan</td>
      <td>18</td>
      <td>3462</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>N</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>67384</th>
      <td>11</td>
      <td>Abernethy1985</td>
      <td>PKDB00001</td>
      <td>age</td>
      <td>9</td>
      <td>OCS</td>
      <td>30.0</td>
      <td>nan</td>
      <td>18</td>
      <td>3462</td>
      <td>NaN</td>
      <td>year</td>
      <td>1.0</td>
      <td>23.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>26.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>67385</th>
      <td>12</td>
      <td>Abernethy1985</td>
      <td>PKDB00001</td>
      <td>species</td>
      <td>9</td>
      <td>OCS</td>
      <td>NaN</td>
      <td>nan</td>
      <td>18</td>
      <td>3462</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>homo sapiens</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>67386</th>
      <td>13</td>
      <td>Abernethy1985</td>
      <td>PKDB00001</td>
      <td>healthy</td>
      <td>9</td>
      <td>OCS</td>
      <td>NaN</td>
      <td>nan</td>
      <td>18</td>
      <td>3462</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Y</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>67387</th>
      <td>14</td>
      <td>Abernethy1985</td>
      <td>PKDB00001</td>
      <td>sex</td>
      <td>9</td>
      <td>OCS</td>
      <td>NaN</td>
      <td>nan</td>
      <td>18</td>
      <td>3462</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>F</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">4001</th>
      <th>80932</th>
      <td>3677</td>
      <td>Tian2019</td>
      <td>30387917</td>
      <td>CYP1A2 genotype</td>
      <td>12</td>
      <td>men</td>
      <td>NaN</td>
      <td>nan</td>
      <td>1</td>
      <td>3999</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>*1a/*1a</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>80933</th>
      <td>3678</td>
      <td>Tian2019</td>
      <td>30387917</td>
      <td>CYP1A2 genotype</td>
      <td>12</td>
      <td>men</td>
      <td>NaN</td>
      <td>nan</td>
      <td>1</td>
      <td>3999</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>*1c/*1f</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>80934</th>
      <td>3681</td>
      <td>Tian2019</td>
      <td>30387917</td>
      <td>CYP1A2 genotype</td>
      <td>12</td>
      <td>men</td>
      <td>NaN</td>
      <td>nan</td>
      <td>2</td>
      <td>3999</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>*1c*1f/*1c*1f</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>80935</th>
      <td>3682</td>
      <td>Tian2019</td>
      <td>30387917</td>
      <td>CYP1A2 genotype</td>
      <td>12</td>
      <td>men</td>
      <td>NaN</td>
      <td>nan</td>
      <td>6</td>
      <td>3999</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>*1a/*1f</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>80936</th>
      <td>3683</td>
      <td>Tian2019</td>
      <td>30387917</td>
      <td>CYP1A2 genotype</td>
      <td>12</td>
      <td>men</td>
      <td>NaN</td>
      <td>nan</td>
      <td>2</td>
      <td>3999</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>*1f/*1f</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>1396 rows × 19 columns</p>
</div><pre class="literal-block">                             Unnamed: 0     study_name  study_sid  group_pk characteristica_pk
3463     67383                       10  Abernethy1985  PKDB00001
         67384                       11  Abernethy1985  PKDB00001
         67385                       12  Abernethy1985  PKDB00001
         67386                       13  Abernethy1985  PKDB00001
         67387                       14  Abernethy1985  PKDB00001
...                                 ...            ...        ...
4001     80932                     3677       Tian2019   30387917
         80933                     3678       Tian2019   30387917
         80934                     3681       Tian2019   30387917
         80935                     3682       Tian2019   30387917
         80936                     3683       Tian2019   30387917

                            measurement_type  group_count group_name   max  group_pk characteristica_pk
3463     67383                       smoking            9        OCS   NaN
         67384                           age            9        OCS  30.0
         67385                       species            9        OCS   NaN
         67386                       healthy            9        OCS   NaN
         67387                           sex            9        OCS   NaN
...                                      ...          ...        ...   ...
4001     80932               CYP1A2 genotype           12        men   NaN
         80933               CYP1A2 genotype           12        men   NaN
         80934               CYP1A2 genotype           12        men   NaN
         80935               CYP1A2 genotype           12        men   NaN
         80936               CYP1A2 genotype           12        men   NaN

                            substance  count  group_parent_pk  sd  unit   se  group_pk characteristica_pk
3463     67383                    nan     18             3462 NaN   NaN  NaN
         67384                    nan     18             3462 NaN  year  1.0
         67385                    nan     18             3462 NaN   NaN  NaN
         67386                    nan     18             3462 NaN   NaN  NaN
         67387                    nan     18             3462 NaN   NaN  NaN
...                               ...    ...              ...  ..   ...  ...
4001     80932                    nan      1             3999 NaN   NaN  NaN
         80933                    nan      1             3999 NaN   NaN  NaN
         80934                    nan      2             3999 NaN   NaN  NaN
         80935                    nan      6             3999 NaN   NaN  NaN
         80936                    nan      2             3999 NaN   NaN  NaN

                              min  cv  median  mean         choice  value
group_pk characteristica_pk
3463     67383                NaN NaN     NaN   NaN              N    NaN
         67384               23.0 NaN     NaN  26.0            NaN    NaN
         67385                NaN NaN     NaN   NaN   homo sapiens    NaN
         67386                NaN NaN     NaN   NaN              Y    NaN
         67387                NaN NaN     NaN   NaN              F    NaN
...                           ...  ..     ...   ...            ...    ...
4001     80932                NaN NaN     NaN   NaN        <a href="#id1"><span class="problematic" id="id2">*</span></a>1a/<a href="#id3"><span class="problematic" id="id4">*</span></a>1a    NaN
         80933                NaN NaN     NaN   NaN        <a href="#id5"><span class="problematic" id="id6">*</span></a>1c/<a href="#id7"><span class="problematic" id="id8">*</span></a>1f    NaN
         80934                NaN NaN     NaN   NaN  <a href="#id9"><span class="problematic" id="id10">*</span></a>1c*1f/<a href="#id11"><span class="problematic" id="id12">*</span></a>1c*1f    NaN
         80935                NaN NaN     NaN   NaN        <a href="#id13"><span class="problematic" id="id14">*</span></a>1a/<a href="#id15"><span class="problematic" id="id16">*</span></a>1f    NaN
         80936                NaN NaN     NaN   NaN        <a href="#id17"><span class="problematic" id="id18">*</span></a>1f/<a href="#id19"><span class="problematic" id="id20">*</span></a>1f    NaN

[1396 rows x 19 columns]</pre>
<p>Often attributes are mixed for groups so we have to exclude the
opposites. In the example, the group <code class="docutils literal notranslate"><span class="pre">20</span></code> consists of 5 smokers and 1
nonsmoker. So for a subset of the group smoking is No. We can exclude
groups via</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">healthy_nonsmoker</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">filter_subject</span><span class="p">([</span><span class="n">is_healthy</span><span class="p">,</span> <span class="n">nonsmoker</span><span class="p">])</span><span class="o">.</span><span class="n">exclude_subject</span><span class="p">([</span><span class="n">smoker</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">healthy_nonsmoker</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">healthy_nonsmoker</span><span class="o">.</span><span class="n">groups_mi</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">------------------------------</span>
<span class="n">PKData</span> <span class="p">(</span><span class="mi">140200051032848</span><span class="p">)</span>
<span class="o">------------------------------</span>
<span class="n">studies</span>            <span class="mi">74</span>  <span class="p">(</span>   <span class="mi">74</span><span class="p">)</span>
<span class="n">groups</span>            <span class="mi">124</span>  <span class="p">(</span> <span class="mi">1144</span><span class="p">)</span>
<span class="n">individuals</span>       <span class="mi">927</span>  <span class="p">(</span> <span class="mi">8619</span><span class="p">)</span>
<span class="n">interventions</span>     <span class="mi">221</span>  <span class="p">(</span>  <span class="mi">221</span><span class="p">)</span>
<span class="n">outputs</span>          <span class="mi">9539</span>  <span class="p">(</span><span class="mi">13730</span><span class="p">)</span>
<span class="n">timecourses</span>       <span class="mi">397</span>  <span class="p">(</span>  <span class="mi">397</span><span class="p">)</span>
<span class="n">scatters</span>           <span class="mi">80</span>  <span class="p">(</span>   <span class="mi">80</span><span class="p">)</span>
<span class="o">------------------------------</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Unnamed: 0</th>
      <th>study_name</th>
      <th>study_sid</th>
      <th>measurement_type</th>
      <th>group_count</th>
      <th>group_name</th>
      <th>max</th>
      <th>substance</th>
      <th>count</th>
      <th>group_parent_pk</th>
      <th>sd</th>
      <th>unit</th>
      <th>se</th>
      <th>min</th>
      <th>cv</th>
      <th>median</th>
      <th>mean</th>
      <th>choice</th>
      <th>value</th>
    </tr>
    <tr>
      <th>group_pk</th>
      <th>characteristica_pk</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">3463</th>
      <th>67383</th>
      <td>10</td>
      <td>Abernethy1985</td>
      <td>PKDB00001</td>
      <td>smoking</td>
      <td>9</td>
      <td>OCS</td>
      <td>NaN</td>
      <td>nan</td>
      <td>18</td>
      <td>3462</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>N</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>67384</th>
      <td>11</td>
      <td>Abernethy1985</td>
      <td>PKDB00001</td>
      <td>age</td>
      <td>9</td>
      <td>OCS</td>
      <td>30.0</td>
      <td>nan</td>
      <td>18</td>
      <td>3462</td>
      <td>NaN</td>
      <td>year</td>
      <td>1.0</td>
      <td>23.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>26.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>67385</th>
      <td>12</td>
      <td>Abernethy1985</td>
      <td>PKDB00001</td>
      <td>species</td>
      <td>9</td>
      <td>OCS</td>
      <td>NaN</td>
      <td>nan</td>
      <td>18</td>
      <td>3462</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>homo sapiens</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>67386</th>
      <td>13</td>
      <td>Abernethy1985</td>
      <td>PKDB00001</td>
      <td>healthy</td>
      <td>9</td>
      <td>OCS</td>
      <td>NaN</td>
      <td>nan</td>
      <td>18</td>
      <td>3462</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Y</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>67387</th>
      <td>14</td>
      <td>Abernethy1985</td>
      <td>PKDB00001</td>
      <td>sex</td>
      <td>9</td>
      <td>OCS</td>
      <td>NaN</td>
      <td>nan</td>
      <td>18</td>
      <td>3462</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>F</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">4001</th>
      <th>80932</th>
      <td>3677</td>
      <td>Tian2019</td>
      <td>30387917</td>
      <td>CYP1A2 genotype</td>
      <td>12</td>
      <td>men</td>
      <td>NaN</td>
      <td>nan</td>
      <td>1</td>
      <td>3999</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>*1a/*1a</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>80933</th>
      <td>3678</td>
      <td>Tian2019</td>
      <td>30387917</td>
      <td>CYP1A2 genotype</td>
      <td>12</td>
      <td>men</td>
      <td>NaN</td>
      <td>nan</td>
      <td>1</td>
      <td>3999</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>*1c/*1f</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>80934</th>
      <td>3681</td>
      <td>Tian2019</td>
      <td>30387917</td>
      <td>CYP1A2 genotype</td>
      <td>12</td>
      <td>men</td>
      <td>NaN</td>
      <td>nan</td>
      <td>2</td>
      <td>3999</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>*1c*1f/*1c*1f</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>80935</th>
      <td>3682</td>
      <td>Tian2019</td>
      <td>30387917</td>
      <td>CYP1A2 genotype</td>
      <td>12</td>
      <td>men</td>
      <td>NaN</td>
      <td>nan</td>
      <td>6</td>
      <td>3999</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>*1a/*1f</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>80936</th>
      <td>3683</td>
      <td>Tian2019</td>
      <td>30387917</td>
      <td>CYP1A2 genotype</td>
      <td>12</td>
      <td>men</td>
      <td>NaN</td>
      <td>nan</td>
      <td>2</td>
      <td>3999</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>*1f/*1f</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>1144 rows × 19 columns</p>
</div><pre class="literal-block">                             Unnamed: 0     study_name  study_sid  group_pk characteristica_pk
3463     67383                       10  Abernethy1985  PKDB00001
         67384                       11  Abernethy1985  PKDB00001
         67385                       12  Abernethy1985  PKDB00001
         67386                       13  Abernethy1985  PKDB00001
         67387                       14  Abernethy1985  PKDB00001
...                                 ...            ...        ...
4001     80932                     3677       Tian2019   30387917
         80933                     3678       Tian2019   30387917
         80934                     3681       Tian2019   30387917
         80935                     3682       Tian2019   30387917
         80936                     3683       Tian2019   30387917

                            measurement_type  group_count group_name   max  group_pk characteristica_pk
3463     67383                       smoking            9        OCS   NaN
         67384                           age            9        OCS  30.0
         67385                       species            9        OCS   NaN
         67386                       healthy            9        OCS   NaN
         67387                           sex            9        OCS   NaN
...                                      ...          ...        ...   ...
4001     80932               CYP1A2 genotype           12        men   NaN
         80933               CYP1A2 genotype           12        men   NaN
         80934               CYP1A2 genotype           12        men   NaN
         80935               CYP1A2 genotype           12        men   NaN
         80936               CYP1A2 genotype           12        men   NaN

                            substance  count  group_parent_pk  sd  unit   se  group_pk characteristica_pk
3463     67383                    nan     18             3462 NaN   NaN  NaN
         67384                    nan     18             3462 NaN  year  1.0
         67385                    nan     18             3462 NaN   NaN  NaN
         67386                    nan     18             3462 NaN   NaN  NaN
         67387                    nan     18             3462 NaN   NaN  NaN
...                               ...    ...              ...  ..   ...  ...
4001     80932                    nan      1             3999 NaN   NaN  NaN
         80933                    nan      1             3999 NaN   NaN  NaN
         80934                    nan      2             3999 NaN   NaN  NaN
         80935                    nan      6             3999 NaN   NaN  NaN
         80936                    nan      2             3999 NaN   NaN  NaN

                              min  cv  median  mean         choice  value
group_pk characteristica_pk
3463     67383                NaN NaN     NaN   NaN              N    NaN
         67384               23.0 NaN     NaN  26.0            NaN    NaN
         67385                NaN NaN     NaN   NaN   homo sapiens    NaN
         67386                NaN NaN     NaN   NaN              Y    NaN
         67387                NaN NaN     NaN   NaN              F    NaN
...                           ...  ..     ...   ...            ...    ...
4001     80932                NaN NaN     NaN   NaN        <a href="#id21"><span class="problematic" id="id22">*</span></a>1a/<a href="#id23"><span class="problematic" id="id24">*</span></a>1a    NaN
         80933                NaN NaN     NaN   NaN        <a href="#id25"><span class="problematic" id="id26">*</span></a>1c/<a href="#id27"><span class="problematic" id="id28">*</span></a>1f    NaN
         80934                NaN NaN     NaN   NaN  <a href="#id29"><span class="problematic" id="id30">*</span></a>1c*1f/<a href="#id31"><span class="problematic" id="id32">*</span></a>1c*1f    NaN
         80935                NaN NaN     NaN   NaN        <a href="#id33"><span class="problematic" id="id34">*</span></a>1a/<a href="#id35"><span class="problematic" id="id36">*</span></a>1f    NaN
         80936                NaN NaN     NaN   NaN        <a href="#id37"><span class="problematic" id="id38">*</span></a>1f/<a href="#id39"><span class="problematic" id="id40">*</span></a>1f    NaN

[1144 rows x 19 columns]</pre>
<p>In addition often combinations of attributes have to be used to find the
correct subjects. For instance a combination of <code class="docutils literal notranslate"><span class="pre">healthy</span></code> and reported
<code class="docutils literal notranslate"><span class="pre">disease</span></code></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">is_healthy</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="c1"># healthy is reported and True</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">measurement_type</span> <span class="o">==</span> <span class="s2">&quot;healthy&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">choice</span> <span class="o">==</span> <span class="s2">&quot;Y&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">disease</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="c1"># any disease is reported</span>
    <span class="k">return</span>  <span class="n">d</span><span class="o">.</span><span class="n">measurement_type</span> <span class="o">==</span> <span class="s2">&quot;disease&quot;</span>

<span class="n">healthy1</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">filter_subject</span><span class="p">(</span><span class="n">is_healthy</span><span class="p">)</span>
<span class="n">healthy2</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">exclude_subject</span><span class="p">(</span><span class="n">disease</span><span class="p">)</span>
<span class="n">healthy3</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">filter_subject</span><span class="p">(</span><span class="n">is_healthy</span><span class="p">)</span><span class="o">.</span><span class="n">exclude_subject</span><span class="p">(</span><span class="n">disease</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">healthy1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">healthy2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">healthy3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">------------------------------</span>
<span class="n">PKData</span> <span class="p">(</span><span class="mi">140200050707600</span><span class="p">)</span>
<span class="o">------------------------------</span>
<span class="n">studies</span>           <span class="mi">111</span>  <span class="p">(</span>  <span class="mi">111</span><span class="p">)</span>
<span class="n">groups</span>            <span class="mi">228</span>  <span class="p">(</span> <span class="mi">2093</span><span class="p">)</span>
<span class="n">individuals</span>      <span class="mi">2165</span>  <span class="p">(</span><span class="mi">17531</span><span class="p">)</span>
<span class="n">interventions</span>     <span class="mi">345</span>  <span class="p">(</span>  <span class="mi">345</span><span class="p">)</span>
<span class="n">outputs</span>         <span class="mi">15746</span>  <span class="p">(</span><span class="mi">25008</span><span class="p">)</span>
<span class="n">timecourses</span>       <span class="mi">607</span>  <span class="p">(</span>  <span class="mi">607</span><span class="p">)</span>
<span class="n">scatters</span>           <span class="mi">80</span>  <span class="p">(</span>   <span class="mi">80</span><span class="p">)</span>
<span class="o">------------------------------</span>
<span class="o">------------------------------</span>
<span class="n">PKData</span> <span class="p">(</span><span class="mi">140200056622672</span><span class="p">)</span>
<span class="o">------------------------------</span>
<span class="n">studies</span>           <span class="mi">119</span>  <span class="p">(</span>  <span class="mi">119</span><span class="p">)</span>
<span class="n">groups</span>            <span class="mi">234</span>  <span class="p">(</span> <span class="mi">2107</span><span class="p">)</span>
<span class="n">individuals</span>      <span class="mi">2259</span>  <span class="p">(</span><span class="mi">17906</span><span class="p">)</span>
<span class="n">interventions</span>     <span class="mi">349</span>  <span class="p">(</span>  <span class="mi">349</span><span class="p">)</span>
<span class="n">outputs</span>         <span class="mi">16367</span>  <span class="p">(</span><span class="mi">25485</span><span class="p">)</span>
<span class="n">timecourses</span>       <span class="mi">620</span>  <span class="p">(</span>  <span class="mi">620</span><span class="p">)</span>
<span class="n">scatters</span>           <span class="mi">80</span>  <span class="p">(</span>   <span class="mi">80</span><span class="p">)</span>
<span class="o">------------------------------</span>
<span class="o">------------------------------</span>
<span class="n">PKData</span> <span class="p">(</span><span class="mi">140200050706000</span><span class="p">)</span>
<span class="o">------------------------------</span>
<span class="n">studies</span>           <span class="mi">110</span>  <span class="p">(</span>  <span class="mi">110</span><span class="p">)</span>
<span class="n">groups</span>            <span class="mi">222</span>  <span class="p">(</span> <span class="mi">2028</span><span class="p">)</span>
<span class="n">individuals</span>      <span class="mi">2058</span>  <span class="p">(</span><span class="mi">16812</span><span class="p">)</span>
<span class="n">interventions</span>     <span class="mi">337</span>  <span class="p">(</span>  <span class="mi">337</span><span class="p">)</span>
<span class="n">outputs</span>         <span class="mi">15472</span>  <span class="p">(</span><span class="mi">24590</span><span class="p">)</span>
<span class="n">timecourses</span>       <span class="mi">603</span>  <span class="p">(</span>  <span class="mi">603</span><span class="p">)</span>
<span class="n">scatters</span>           <span class="mi">80</span>  <span class="p">(</span>   <span class="mi">80</span><span class="p">)</span>
<span class="o">------------------------------</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="query-interventions">
<h2>3 Query interventions<a class="headerlink" href="#query-interventions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="get-outputs-timecourses-for-intervention-with-substance">
<h3>3.1 Get outputs/timecourses for intervention with substance<a class="headerlink" href="#get-outputs-timecourses-for-intervention-with-substance" title="Permalink to this headline">¶</a></h3>
<p>intervention with measurement_type “dosing” and substance “caffeine”</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">dosing_and_caffeine</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;measurement_type&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;dosing&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;substance&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;caffeine&quot;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_data</span> <span class="o">=</span> <span class="n">PKData</span><span class="o">.</span><span class="n">from_archive</span><span class="p">(</span><span class="n">TESTDATA_CONCISE_FALSE_ZIP</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">caffeine_data</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">filter_intervention</span><span class="p">(</span><span class="n">dosing_and_caffeine</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">caffeine_data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">------------------------------</span>
<span class="n">PKData</span> <span class="p">(</span><span class="mi">140200056614544</span><span class="p">)</span>
<span class="o">------------------------------</span>
<span class="n">studies</span>             <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">groups</span>              <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">individuals</span>         <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">interventions</span>       <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">outputs</span>             <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">timecourses</span>         <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">scatters</span>           <span class="mi">80</span>  <span class="p">(</span>   <span class="mi">80</span><span class="p">)</span>
<span class="o">------------------------------</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="query-outputs-timecourses">
<h2>4 Query outputs/timecourses<a class="headerlink" href="#query-outputs-timecourses" title="Permalink to this headline">¶</a></h2>
<div class="section" id="query-by-measurement-type">
<h3>4.1 query by measurement_type<a class="headerlink" href="#query-by-measurement-type" title="Permalink to this headline">¶</a></h3>
<p>filter all outputs with measurement_type auc_inf</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">is_auc_inf</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;measurement_type&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;auc_inf&quot;</span><span class="p">)</span>

<span class="n">test_data</span> <span class="o">=</span> <span class="n">PKData</span><span class="o">.</span><span class="n">from_archive</span><span class="p">(</span><span class="n">TESTDATA_CONCISE_FALSE_ZIP</span><span class="p">)</span>

<span class="n">test_data</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">filter_output</span><span class="p">(</span><span class="n">is_auc_inf</span><span class="p">)</span><span class="o">.</span><span class="n">delete_timecourses</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">------------------------------</span>
<span class="n">PKData</span> <span class="p">(</span><span class="mi">140200056576144</span><span class="p">)</span>
<span class="o">------------------------------</span>
<span class="n">studies</span>             <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">groups</span>              <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">individuals</span>         <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">interventions</span>       <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">outputs</span>             <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">timecourses</span>         <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">scatters</span>           <span class="mi">80</span>  <span class="p">(</span>   <span class="mi">80</span><span class="p">)</span>
<span class="o">------------------------------</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="other-query-others">
<h2>5 Other Query others<a class="headerlink" href="#other-query-others" title="Permalink to this headline">¶</a></h2>
<div class="section" id="complex">
<h3>5.1 Complex<a class="headerlink" href="#complex" title="Permalink to this headline">¶</a></h3>
<p>get clearance of codeine for all.h5 subjects, which have been phenotyped
for cyp2d6.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">is_cyp2d6_phenotyped</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="n">cyp2d6_phenotype_substances</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;spar/(2hspar+5hspar)&#39;</span><span class="p">,</span> <span class="s1">&#39;deb/4hdeb&#39;</span><span class="p">,</span> <span class="s1">&#39;dtf/dmt&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;measurement_type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;metabolic phenotype&quot;</span><span class="p">,</span> <span class="s2">&quot;metabolic ratio&quot;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;substance&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">cyp2d6_phenotype_substances</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">codeine_clearance</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;measurement_type&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;clearance&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;substance&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;codeine&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_data</span> <span class="o">=</span> <span class="n">PKData</span><span class="o">.</span><span class="n">from_archive</span><span class="p">(</span><span class="n">TESTDATA_CONCISE_FALSE_ZIP</span><span class="p">)</span>

<span class="n">phenotyped_data</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">filter_output</span><span class="p">(</span><span class="n">is_cyp2d6_phenotyped</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_data</span><span class="o">.</span><span class="n">groups</span> <span class="o">=</span> <span class="n">phenotyped_data</span><span class="o">.</span><span class="n">groups</span>
<span class="n">test_data</span><span class="o">.</span><span class="n">individuals</span> <span class="o">=</span> <span class="n">phenotyped_data</span><span class="o">.</span><span class="n">individuals</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">filter_output</span><span class="p">(</span><span class="n">codeine_clearance</span><span class="p">)</span><span class="o">.</span><span class="n">delete_timecourses</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">------------------------------</span>
<span class="n">PKData</span> <span class="p">(</span><span class="mi">140200045658512</span><span class="p">)</span>
<span class="o">------------------------------</span>
<span class="n">studies</span>             <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">groups</span>              <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">individuals</span>         <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">interventions</span>       <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">outputs</span>             <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">timecourses</span>         <span class="mi">0</span>  <span class="p">(</span>    <span class="mi">0</span><span class="p">)</span>
<span class="n">scatters</span>           <span class="mi">80</span>  <span class="p">(</span>   <span class="mi">80</span><span class="p">)</span>
<span class="o">------------------------------</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019, Jan Grzegorzewski &amp; Matthias König

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>